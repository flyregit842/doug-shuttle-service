<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doug Shuttle Service - 機場接送預約</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: system-ui, sans-serif; background: #f5f5f5; padding: 20px; }
        .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { background: #667eea; color: white; padding: 20px; text-align: center; border-radius: 10px 10px 0 0; }
        .content { padding: 20px; }
        .step { display: none; }
        .step.active { display: block; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; }
        .service-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }
        .service-card { padding: 20px; border: 2px solid #ddd; border-radius: 5px; text-align: center; cursor: pointer; }
        .service-card.selected { border-color: #667eea; background: #f0f4ff; }
        .btn { padding: 12px 24px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        .btn:hover { background: #5a67d8; }
        .btn-outline { background: transparent; border: 2px solid #667eea; color: #667eea; }
        .btn-group { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
        .loading { display: none; text-align: center; color: #666; }
        .toast { position: fixed; top: 20px; right: 20px; padding: 15px; border-radius: 5px; z-index: 1000; }
        .toast-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .toast-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        @media (max-width: 600px) { .container { margin: 10px; } .btn-group { flex-direction: column; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Doug Shuttle Service</h1>
            <p>機場接送預約系統</p>
        </div>
        
        <div class="content">
            <!-- 步驟1: 選擇服務 -->
            <div class="step active" id="step1">
                <h3>選擇服務項目</h3>
                <div class="service-grid">
                    <div class="service-card" data-service="送機">
                        <h4>✈️ 送機</h4>
                        <p>前往機場</p>
                    </div>
                    <div class="service-card" data-service="接機">
                        <h4>🏠 接機</h4>
                        <p>機場回來</p>
                    </div>
                    <div class="service-card" data-service="包車">
                        <h4>🚗 包車</h4>
                        <p>客製行程</p>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn" id="next1" disabled>下一步</button>
                </div>
            </div>

            <!-- 步驟2: 基本資訊 -->
            <div class="step" id="step2">
                <h3>基本資訊</h3>
                <div class="form-group">
                    <label for="phone">手機號碼 *</label>
                    <input type="tel" id="phone" placeholder="0912-345-678" required>
                    <div class="loading" id="loading">查詢中...</div>
                </div>
                <div class="form-group">
                    <label for="name">姓名 *</label>
                    <input type="text" id="name" placeholder="王總" required>
                </div>
                <div class="form-group">
                    <label for="company">公司名稱</label>
                    <input type="text" id="company" placeholder="ABC科技">
                </div>
                <div class="btn-group">
                    <button class="btn btn-outline" id="prev2">上一步</button>
                    <button class="btn" id="next2">下一步</button>
                </div>
            </div>

            <!-- 步驟3: 時間地點 -->
            <div class="step" id="step3">
                <h3>時間與地點</h3>
                <div class="form-group">
                    <label for="date">服務日期 *</label>
                    <input type="date" id="date" required>
                </div>
                <div class="form-group">
                    <label for="time">出發時間 *</label>
                    <input type="time" id="time" required>
                </div>
                <div class="form-group">
                    <label for="pickup">上車地點 *</label>
                    <input type="text" id="pickup" placeholder="台北車站" required>
                </div>
                <div class="form-group">
                    <label for="dropoff">下車地點 *</label>
                    <input type="text" id="dropoff" placeholder="桃園機場" required>
                </div>
                <div class="form-group">
                    <label for="remarks">備註</label>
                    <textarea id="remarks" placeholder="特殊需求"></textarea>
                </div>
                <div class="btn-group">
                    <button class="btn btn-outline" id="prev3">上一步</button>
                    <button class="btn" id="next3">下一步</button>
                </div>
            </div>

            <!-- 步驟4: 確認 -->
            <div class="step" id="step4">
                <h3>確認預約資訊</h3>
                <div id="summary" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                    <!-- 確認資訊 -->
                </div>
                <div class="btn-group">
                    <button class="btn btn-outline" id="prev4">返回修改</button>
                    <button class="btn" id="submit">確認預約</button>
                </div>
            </div>

            <!-- 完成 -->
            <div class="step" id="complete" style="text-align: center;">
                <h2 style="color: #28a745;">🎉 預約成功！</h2>
                <p>Email確認已發送</p>
                <div class="btn-group">
                    <a href="query.html" class="btn">查看預約</a>
                    <button class="btn btn-outline" onclick="location.reload()">新預約</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedService = '';
        let formData = {};

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').min = today;
            
            // 服務選擇
            document.querySelectorAll('.service-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.service-card').forEach(c => c.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedService = this.dataset.service;
                    document.getElementById('next1').disabled = false;
                });
            });

            // 手機號碼查詢
            let timeout;
            document.getElementById('phone').addEventListener('input', function() {
                clearTimeout(timeout);
                const phone = this.value.replace(/\D/g, '');
                if (phone.length >= 10) {
                    timeout = setTimeout(() => {
                        document.getElementById('loading').style.display = 'block';
                        setTimeout(() => {
                            document.getElementById('loading').style.display = 'none';
                            if (phone === '0912345678') {
                                document.getElementById('name').value = '王總';
                                document.getElementById('company').value = 'ABC科技';
                                showToast('已帶入資料', 'success');
                            }
                        }, 500);
                    }, 300);
                }
            });

            // 導航
            document.getElementById('next1').addEventListener('click', () => goToStep(2));
            document.getElementById('prev2').addEventListener('click', () => goToStep(1));
            document.getElementById('next2').addEventListener('click', () => goToStep(3));
            document.getElementById('prev3').addEventListener('click', () => goToStep(2));
            document.getElementById('next3').addEventListener('click', () => goToStep(4));
            document.getElementById('prev4').addEventListener('click', () => goToStep(3));
            document.getElementById('submit').addEventListener('click', submitForm);
        });

        function goToStep(step) {
            if (!validateStep()) return;
            
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById('step' + step).classList.add('active');
            
            if (step === 4) generateSummary();
            currentStep = step;
        }

        function validateStep() {
            switch(currentStep) {
                case 1: return selectedService !== '';
                case 2: return document.getElementById('phone').value && document.getElementById('name').value;
                case 3: return document.getElementById('date').value && document.getElementById('time').value && 
                              document.getElementById('pickup').value && document.getElementById('dropoff').value;
            }
            return true;
        }

        function generateSummary() {
            const summary = document.getElementById('summary');
            summary.innerHTML = `
                <div><strong>服務：</strong> ${selectedService}</div>
                <div><strong>日期：</strong> ${document.getElementById('date').value}</div>
                <div><strong>時間：</strong> ${document.getElementById('time').value}</div>
                <div><strong>上車：</strong> ${document.getElementById('pickup').value}</div>
                <div><strong>下車：</strong> ${document.getElementById('dropoff').value}</div>
                <div><strong>聯絡：</strong> ${document.getElementById('name').value} (${document.getElementById('phone').value})</div>
            `;
        }

        function submitForm() {
            const btn = document.getElementById('submit');
            btn.disabled = true;
            btn.textContent = '處理中...';
            
            setTimeout(() => {
                document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
                document.getElementById('complete').classList.add('active');
                showToast('預約建立成功', 'success');
            }, 1500);
        }

        function showToast(message, type) {
            // 移除舊的toast
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // 3秒後自動移除
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 3000);
        }

        // 除錯用：檢查所有事件是否正確綁定
        function debugEvents() {
            console.log('Selected Service:', selectedService);
            console.log('Current Step:', currentStep);
            console.log('Service Cards:', document.querySelectorAll('.service-card').length);
            console.log('Buttons:', {
                next1: document.getElementById('next1'),
                prev2: document.getElementById('prev2'),
                next2: document.getElementById('next2'),
                prev3: document.getElementById('prev3'),
                next3: document.getElementById('next3'),
                prev4: document.getElementById('prev4'),
                submit: document.getElementById('submit')
            });
        }

        // 在控制台輸入 debugEvents() 來檢查狀態
    </script>
</body>
</html>
